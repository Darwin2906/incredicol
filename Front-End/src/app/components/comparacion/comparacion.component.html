<div class="container mt-4">
  <div class="card shadow-sm">
    <div class="card-header bg-success text-white">
      <h2 class="mb-0"><i class="bi bi-calculator me-2"></i>COMPARADOR DE CRÉDITOS</h2>
    </div>
    <div class="card-body">
      <form>
        <!-- Monto -->
        <div class="mb-3">
          <label for="monto" class="form-label">Monto solicitado (COP):</label>
          <div class="input-group">
            <span class="input-group-text">$</span>
            <input
              type="number"
              id="monto"
              [(ngModel)]="monto"
              name="monto"
              (ngModelChange)="calcularOpciones()"
              [min]="100000"
              [max]="5000000"
              class="form-control"
              required
              placeholder="Ej: 500.000"
            />
          </div>
          <div class="form-text">Monto mínimo: $100.000 - Máximo: $5.000.000</div>
          <small *ngIf="monto < 100000 || monto > 5000000" class="text-danger">
            El monto debe estar entre $100.000 y $5.000.000.
          </small>
        </div>

        <!-- Plazo -->
        <div class="mb-4">
          <label for="plazo" class="form-label">Plazo (días):</label>
          <input
            type="range"
            id="plazo"
            [(ngModel)]="plazo"
            name="plazo"
            (ngModelChange)="calcularOpciones()"
            [min]="1"
            [max]="365"
            class="form-range"
            required
          />
          <div class="d-flex justify-content-between">
            <small>1 día</small>
            <span class="badge bg-primary">Seleccionado: {{plazo}} días</span>
            <small>365 días</small>
          </div>
          
          <!-- Guía visual de plazos -->
          <div class="mt-3">
            <div class="progress mb-2" style="height: 20px;">
              <div 
                class="progress-bar bg-danger" 
                role="progressbar" 
                [style.width]="'15%'"
                data-bs-toggle="tooltip" 
                title="Plazos cortos (1-30 días)"
              ></div>
              <div 
                class="progress-bar bg-warning" 
                role="progressbar" 
                [style.width]="'25%'"
                data-bs-toggle="tooltip" 
                title="Plazos medios (31-90 días)"
              ></div>
              <div 
                class="progress-bar bg-success" 
                role="progressbar" 
                [style.width]="'60%'"
                data-bs-toggle="tooltip" 
                title="Plazos largos (91-365 días)"
              ></div>
            </div>
            <div class="d-flex justify-content-between small">
              <span class="text-danger">Corto plazo</span>
              <span class="text-warning">Medio plazo</span>
              <span class="text-success">Largo plazo</span>
            </div>
          </div>
        </div>
      </form>

      <!-- Resultados -->
      <div *ngIf="plataformasFiltradas.length > 0" class="mt-4">
        <h4 class="border-bottom pb-2">
          <i class="bi bi-check-circle-fill text-success me-2"></i>
          Resultados disponibles para {{plazo}} días
        </h4>
        
        <div class="alert alert-info">
          <i class="bi bi-info-circle me-2"></i>
          <strong>Tip:</strong> 
          <span *ngIf="plazo <= 30">Estás buscando plazos cortos. Estas plataformas son ideales para emergencias o necesidades inmediatas.</span>
          <span *ngIf="plazo > 30 && plazo <= 90">Estás buscando plazos medios. Perfecto para proyectos a corto plazo.</span>
          <span *ngIf="plazo > 90">Estás buscando plazos largos. Ideal para inversiones o planes a más largo plazo.</span>
        </div>
        
        <div class="table-responsive">
          <table class="table table-striped table-hover">
            <thead class="table-dark">
              <tr>
                <th>Plataforma</th>
                <th>Tipo de plazo</th>
                <th>Rango de días</th>
                <th>Acción</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let p of plataformasFiltradas">
                <td>
                  <strong>{{ p.nombre }}</strong>
                  <span *ngIf="p.destacado" class="badge bg-warning ms-2">Recomendada</span>
                </td>
                <td>
                  <span *ngIf="p.plazoMax <= 30" class="badge bg-danger">Corto plazo</span>
                  <span *ngIf="p.plazoMax > 30 && p.plazoMax <= 90" class="badge bg-warning">Medio plazo</span>
                  <span *ngIf="p.plazoMax > 90" class="badge bg-success">Largo plazo</span>
                </td>
                <td>{{ p.plazoMin }} - {{ p.plazoMax }} días</td>
                <td>
                  <button class="btn btn-outline-primary btn-sm" (click)="irASimulador(p.id)">
                    <i class="bi bi-calculator me-1"></i> Simular
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div *ngIf="plataformasFiltradas.length === 0 && monto >= 100000 && plazo >= 1" class="mt-4 alert alert-warning">
        <i class="bi bi-exclamation-triangle me-2"></i>
        <strong>No hay plataformas disponibles</strong> para el monto y plazo seleccionados. 
        Intenta ajustar los valores para ver más opciones.
      </div>
    </div>
  </div>
</div>